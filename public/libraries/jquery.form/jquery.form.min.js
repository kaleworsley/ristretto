/*!
 * jQuery Form Plugin
 * version: 2.94 (13-DEC-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *	http://www.opensource.org/licenses/mit-license.php
 *	http://www.gnu.org/licenses/gpl.html
 */

(function(c){function o(){if(c.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}c.fn.ajaxSubmit=function(a){function h(b){for(var f=new FormData,h=0;h<b.length;h++)"file"!=b[h].type&&f.append(b[h].name,b[h].value);g.find("input:file:enabled").each(function(){var a=c(this).attr("name"),b=this.files;if(a)for(var g=0;g<b.length;g++)f.append(a,b[g])});
if(a.extraData)for(var k in a.extraData)f.append(k,a.extraData[k]);a.data=null;b=c.extend(!0,{},c.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:"POST"});b.context=b.context||b;b.data=null;var d=b.beforeSend;b.beforeSend=function(c,b){b.data=f;if(c.upload)c.upload.onprogress=function(a){b.progress(a.position,a.total)};d&&d.call(b,c,a)};c.ajax(b)}function d(b){function h(){function a(){try{var b=(m.contentWindow?m.contentWindow.document:m.contentDocument?m.contentDocument:m.document).readyState;
o("state = "+b);"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){o("Server abort: ",c," (",c.name,")"),k(u),s&&clearTimeout(s),s=void 0}}var b=g.attr("target"),i=g.attr("action");d.setAttribute("target",q);f||d.setAttribute("method","POST");i!=e.url&&d.setAttribute("action",e.url);!e.skipEncodingOverride&&(!f||/post/i.test(f))&&g.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&(s=setTimeout(function(){v=!0;k(y)},e.timeout));var j=[];try{if(e.extraData)for(var l in e.extraData)j.push(c('<input type="hidden" name="'+
l+'">').attr("value",e.extraData[l]).appendTo(d)[0]);e.iframeTarget||(r.appendTo("body"),m.attachEvent?m.attachEvent("onload",k):m.addEventListener("load",k,!1));setTimeout(a,15);d.submit()}finally{d.setAttribute("action",i),b?d.setAttribute("target",b):g.removeAttr("target"),c(j).remove()}}function k(a){if(!i.aborted&&!z){try{p=m.contentWindow?m.contentWindow.document:m.contentDocument?m.contentDocument:m.document}catch(b){o("cannot access response document: ",b),a=u}if(a===y&&i)i.abort("timeout");
else if(a==u&&i)i.abort("server abort");else if(p&&p.location.href!=e.iframeSrc||v){m.detachEvent?m.detachEvent("onload",k):m.removeEventListener("load",k,!1);var a="success",f;try{if(v)throw"timeout";var d="xml"==e.dataType||p.XMLDocument||c.isXMLDoc(p);o("isXml="+d);if(!d&&window.opera&&(null==p.body||""==p.body.innerHTML)&&--w){o("requeing onLoad callback, DOM not available");setTimeout(k,250);return}var g=p.body?p.body:p.documentElement;i.responseText=g?g.innerHTML:null;i.responseXML=p.XMLDocument?
p.XMLDocument:p;if(d)e.dataType="xml";i.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};if(g)i.status=Number(g.getAttribute("status"))||i.status,i.statusText=g.getAttribute("statusText")||i.statusText;var h=(e.dataType||"").toLowerCase(),j=/(json|script|text)/.test(h);if(j||e.textarea){var l=p.getElementsByTagName("textarea")[0];if(l)i.responseText=l.value,i.status=Number(l.getAttribute("status"))||i.status,i.statusText=l.getAttribute("statusText")||i.statusText;else if(j){var q=
p.getElementsByTagName("pre")[0],t=p.getElementsByTagName("body")[0];if(q)i.responseText=q.textContent?q.textContent:q.innerText;else if(t)i.responseText=t.textContent?t.textContent:t.innerText}}else if("xml"==h&&!i.responseXML&&null!=i.responseText)i.responseXML=C(i.responseText);try{A=D(i,h,e)}catch(B){a="parsererror",i.error=f=B||a}}catch(x){o("error caught: ",x),a="error",i.error=f=x||a}i.aborted&&(o("upload aborted"),a=null);i.status&&(a=200<=i.status&&300>i.status||304===i.status?"success":
"error");if("success"===a)e.success&&e.success.call(e.context,A,"success",i),n&&c.event.trigger("ajaxSuccess",[i,e]);else if(a){if(void 0==f)f=i.statusText;e.error&&e.error.call(e.context,i,a,f);n&&c.event.trigger("ajaxError",[i,e,f])}n&&c.event.trigger("ajaxComplete",[i,e]);n&&!--c.active&&c.event.trigger("ajaxStop");e.complete&&e.complete.call(e.context,i,a);z=!0;e.timeout&&clearTimeout(s);setTimeout(function(){e.iframeTarget||r.remove();i.responseXML=null},100)}}}var d=g[0],j,l,e,n,q,r,m,i,v,s;
j=!!c.fn.prop;if(b)if(j)for(l=0;l<b.length;l++)j=c(d[b[l].name]),j.prop("disabled",!1);else for(l=0;l<b.length;l++)j=c(d[b[l].name]),j.removeAttr("disabled");if(c(":input[name=submit],:input[id=submit]",d).length)alert('Error: Form elements must not have name or id of "submit".');else if(e=c.extend(!0,{},c.ajaxSettings,a),e.context=e.context||e,q="jqFormIO"+(new Date).getTime(),e.iframeTarget?(r=c(e.iframeTarget),j=r.attr("name"),null==j?r.attr("name",q):q=j):(r=c('<iframe name="'+q+'" src="'+e.iframeSrc+
'" />'),r.css({position:"absolute",top:"-1000px",left:"-1000px"})),m=r[0],i={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b="timeout"===a?"timeout":"aborted";o("aborting upload... "+b);this.aborted=1;r.attr("src",e.iframeSrc);i.error=b;e.error&&e.error.call(e.context,i,b,a);n&&c.event.trigger("ajaxError",[i,e,b]);e.complete&&e.complete.call(e.context,i,b)}},
(n=e.global)&&!c.active++&&c.event.trigger("ajaxStart"),n&&c.event.trigger("ajaxSend",[i,e]),e.beforeSend&&!1===e.beforeSend.call(e.context,i,e))e.global&&c.active--;else if(!i.aborted){if(b=d.clk)if((j=b.name)&&!b.disabled)if(e.extraData=e.extraData||{},e.extraData[j]=b.value,"image"==b.type)e.extraData[j+".x"]=d.clk_x,e.extraData[j+".y"]=d.clk_y;var y=1,u=2,b=c("meta[name=csrf-token]").attr("content");if((j=c("meta[name=csrf-param]").attr("content"))&&b)e.extraData=e.extraData||{},e.extraData[j]=
b;e.forceSync?h():setTimeout(h,10);var A,p,w=50,z,C=c.parseXML||function(a,b){window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},E=c.parseJSON||function(a){return window.eval("("+a+")")},D=function(a,b,e){var f=a.getResponseHeader("content-type")||"",g="xml"===b||!b&&0<=f.indexOf("xml"),a=g?a.responseXML:a.responseText;g&&"parsererror"===
a.documentElement.nodeName&&c.error&&c.error("parsererror");e&&e.dataFilter&&(a=e.dataFilter(a,b));"string"===typeof a&&("json"===b||!b&&0<=f.indexOf("json")?a=E(a):("script"===b||!b&&0<=f.indexOf("javascript"))&&c.globalEval(a));return a}}}if(!this.length)return o("ajaxSubmit: skipping submit process - no element selected"),this;var f,b,g=this;"function"==typeof a&&(a={success:a});f=this.attr("method");b=this.attr("action");(b=(b="string"===typeof b?c.trim(b):"")||window.location.href||"")&&(b=(b.match(/^([^#]+)/)||
[])[1]);a=c.extend(!0,{url:b,success:c.ajaxSettings.success,type:f||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);b={};this.trigger("form-pre-serialize",[this,a,b]);if(b.veto)return o("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return o("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var k=a.traditional;if(void 0===k)k=c.ajaxSettings.traditional;var j,l=this.formToArray(a.semantic);
if(a.data)a.extraData=a.data,j=c.param(a.data,k);if(a.beforeSubmit&&!1===a.beforeSubmit(l,this,a))return o("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[l,this,a,b]);if(b.veto)return o("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;b=c.param(l,k);j&&(b=b?b+"&"+j:j);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+b,a.data=null):a.data=b;var n=[];a.resetForm&&n.push(function(){g.resetForm()});a.clearForm&&n.push(function(){g.clearForm(a.includeHidden)});
if(!a.dataType&&a.target){var w=a.success||function(){};n.push(function(b){var f=a.replaceTarget?"replaceWith":"html";c(a.target)[f](b).each(w,arguments)})}else a.success&&n.push(a.success);a.success=function(b,c,f){for(var d=a.context||a,h=0,k=n.length;h<k;h++)n[h].apply(d,[b,c,f||g,g])};k=c("input:file:enabled[value]",this);j=0<k.length;b="multipart/form-data"==g.attr("enctype")||"multipart/form-data"==g.attr("encoding");k=!(!j||!k.get(0).files||!window.FormData);o("fileAPI :"+k);!1!==a.iframe&&
(a.iframe||(j||b)&&!k)?a.closeKeepAlive?c.get(a.closeKeepAlive,function(){d(l)}):d(l):(j||b)&&k?(a.progress=a.progress||c.noop,h(l)):c.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};c.fn.ajaxForm=function(a){if(0===this.length){var h=this.selector,d=this.context;if(!c.isReady&&h)return o("DOM not ready, queuing ajaxForm"),c(function(){c(h,d).ajaxForm(a)}),this;o("terminating; zero elements found by selector"+(c.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",
function(f){f.isDefaultPrevented()||(f.preventDefault(),c(this).ajaxSubmit(a))}).bind("click.form-plugin",function(a){var b=a.target,g=c(b);if(!g.is(":submit,input:image")){b=g.closest(":submit");if(0==b.length)return;b=b[0]}var d=this;d.clk=b;if("image"==b.type)void 0!=a.offsetX?(d.clk_x=a.offsetX,d.clk_y=a.offsetY):"function"==typeof c.fn.offset?(g=g.offset(),d.clk_x=a.pageX-g.left,d.clk_y=a.pageY-g.top):(d.clk_x=a.pageX-b.offsetLeft,d.clk_y=a.pageY-b.offsetTop);setTimeout(function(){d.clk=d.clk_x=
d.clk_y=null},100)})};c.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};c.fn.formToArray=function(a){var h=[];if(0===this.length)return h;var d=this[0],f=a?d.getElementsByTagName("*"):d.elements;if(!f)return h;var b,g,k,j,l,n;for(b=0,l=f.length;b<l;b++)if(g=f[b],k=g.name)if(a&&d.clk&&"image"==g.type)!g.disabled&&d.clk==g&&(h.push({name:k,value:c(g).val(),type:g.type}),h.push({name:k+".x",value:d.clk_x},{name:k+".y",value:d.clk_y}));else if((j=c.fieldValue(g,
!0))&&j.constructor==Array)for(g=0,n=j.length;g<n;g++)h.push({name:k,value:j[g]});else null!==j&&"undefined"!=typeof j&&h.push({name:k,value:j,type:g.type});if(!a&&d.clk&&(a=c(d.clk),f=a[0],(k=f.name)&&!f.disabled&&"image"==f.type))h.push({name:k,value:a.val()}),h.push({name:k+".x",value:d.clk_x},{name:k+".y",value:d.clk_y});return h};c.fn.formSerialize=function(a){return c.param(this.formToArray(a))};c.fn.fieldSerialize=function(a){var h=[];this.each(function(){var d=this.name;if(d){var f=c.fieldValue(this,
a);if(f&&f.constructor==Array)for(var b=0,g=f.length;b<g;b++)h.push({name:d,value:f[b]});else null!==f&&"undefined"!=typeof f&&h.push({name:this.name,value:f})}});return c.param(h)};c.fn.fieldValue=function(a){for(var h=[],d=0,f=this.length;d<f;d++){var b=c.fieldValue(this[d],a);null===b||"undefined"==typeof b||b.constructor==Array&&!b.length||(b.constructor==Array?c.merge(h,b):h.push(b))}return h};c.fieldValue=function(a,h){var d=a.name,f=a.type,b=a.tagName.toLowerCase();void 0===h&&(h=!0);if(h&&
(!d||a.disabled||"reset"==f||"button"==f||("checkbox"==f||"radio"==f)&&!a.checked||("submit"==f||"image"==f)&&a.form&&a.form.clk!=a||"select"==b&&-1==a.selectedIndex))return null;if("select"==b){var g=a.selectedIndex;if(0>g)return null;for(var d=[],b=a.options,k=(f="select-one"==f)?g+1:b.length,g=f?g:0;g<k;g++){var j=b[g];if(j.selected){var l=j.value;l||(l=j.attributes&&j.attributes.value&&!j.attributes.value.specified?j.text:j.value);if(f)return l;d.push(l)}}return d}return c(a).val()};c.fn.clearForm=
function(a){return this.each(function(){c("input,select,textarea",this).clearFields(a)})};c.fn.clearFields=c.fn.clearInputs=function(a){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,f=this.tagName.toLowerCase();if(c.test(d)||"textarea"==f||a&&/hidden/.test(d))this.value="";else if("checkbox"==d||"radio"==d)this.checked=!1;else if("select"==f)this.selectedIndex=-1})};c.fn.resetForm=function(){return this.each(function(){("function"==
typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};c.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};c.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var h=this.type;if("checkbox"==h||"radio"==h)this.checked=a;else if("option"==this.tagName.toLowerCase())h=c(this).parent("select"),a&&h[0]&&"select-one"==h[0].type&&h.find("option").selected(!1),this.selected=a})};c.fn.ajaxSubmit.debug=!1})(jQuery);
